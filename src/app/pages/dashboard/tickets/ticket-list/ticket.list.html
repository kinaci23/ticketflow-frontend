<div class="bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 overflow-hidden mt-6">
  
  <div class="p-6 border-b border-slate-200 dark:border-slate-800 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
    <h2 class="text-xl font-bold text-slate-800 dark:text-white">
      {{ userRole === 'Admin' ? 'TÃ¼m Sistem Biletleri' : 'Destek Taleplerim' }}
    </h2>

    <div *ngIf="userRole === 'Admin'" class="flex items-center gap-3">
      <span class="text-sm font-semibold text-slate-500">Kategori Filtresi:</span>
      <select (change)="onCategoryChange($any($event.target).value)" 
              class="border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-800 text-sm text-slate-700 dark:text-slate-200 rounded-lg p-2.5 focus:ring-primary focus:border-primary outline-none cursor-pointer shadow-sm">
        <option value="All">BÃ¼tÃ¼n Kategoriler</option>
        <option value="1">YazÄ±lÄ±m / Uygulama</option>
        <option value="2">DonanÄ±m / ArÄ±za</option>
        <option value="3">AÄŸ ve Ä°nternet</option>
        <option value="4">KullanÄ±cÄ± Ä°ÅŸlemleri / Åžifre</option>
      </select>
    </div>
  </div>

  <div class="overflow-x-auto">
    <table class="w-full text-left border-collapse">
      <thead class="bg-slate-50 dark:bg-slate-800/50">
        <tr>
          <th class="p-4 text-xs font-semibold text-slate-500 uppercase tracking-wider">BaÅŸlÄ±k</th>
          
          <th *ngIf="userRole === 'Admin'" (click)="sortTable('userName')" class="p-4 text-xs font-semibold text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">
            OluÅŸturan <span *ngIf="sortColumn === 'userName'">{{ sortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
          </th>
          
          <th *ngIf="userRole === 'Admin'" (click)="sortTable('categoryName')" class="p-4 text-xs font-semibold text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">
            YZ Kategori <span *ngIf="sortColumn === 'categoryName'">{{ sortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
          </th>
          
          <th (click)="sortTable('status')" class="p-4 text-xs font-semibold text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">
            Durum <span *ngIf="sortColumn === 'status'">{{ sortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
          </th>
          
          <th (click)="sortTable('urgency')" class="p-4 text-xs font-semibold text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">
            Ã–ncelik <span *ngIf="sortColumn === 'urgency'">{{ sortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
          </th>
          
          <th (click)="sortTable('createdAt')" class="p-4 text-xs font-semibold text-slate-500 uppercase tracking-wider cursor-pointer hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">
            Tarih <span *ngIf="sortColumn === 'createdAt'">{{ sortDirection === 'asc' ? 'â†‘' : 'â†“' }}</span>
          </th>
          
          <th class="p-4 text-xs font-semibold text-slate-500 uppercase tracking-wider">Ä°ÅŸlem</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-slate-200 dark:divide-slate-800">
        <tr *ngFor="let ticket of displayedTickets" class="hover:bg-slate-50 dark:hover:bg-slate-800/30 transition-colors">
          
          <td class="p-4 font-medium text-slate-700 dark:text-slate-200">{{ ticket.title || ticket['Title'] }}</td>
          
          <td *ngIf="userRole === 'Admin'" class="p-4 text-sm font-semibold text-indigo-600 dark:text-indigo-400">
            {{ ticket.userName || ticket['UserName'] || 'Bilinmiyor' }}
          </td>
          
          <td *ngIf="userRole === 'Admin'" class="p-4">
            <span class="px-2 py-1 rounded-md text-xs font-bold bg-purple-50 text-purple-700 border border-purple-200 flex items-center gap-1 w-max">
              ðŸ¤– {{ getCategoryName(ticket.finalCategoryId || ticket['FinalCategoryId'] || ticket.predictedCategoryId || ticket['PredictedCategoryId']) }}
            </span>
          </td>
          
          <td class="p-4">
            <span class="px-2.5 py-1 rounded-full text-xs font-bold transition-colors tracking-wide"
                  [ngClass]="getStatusClass(ticket.status || ticket['Status'] || 'AÃ§Ä±k')">
              {{ ticket.status || ticket['Status'] || 'AÃ§Ä±k' }}
            </span>
          </td>
          
          <td class="p-4">
            <span class="px-2.5 py-1 rounded-full text-xs transition-colors tracking-wide"
                  [ngClass]="getUrgencyClass(ticket.urgency || ticket['Urgency'] || '')">
              {{ ticket.urgency || ticket['Urgency'] || 'Belirtilmedi' }}
            </span>
          </td>
          
          <td class="p-4 text-sm text-slate-600 dark:text-slate-400">
            {{ (ticket.createdAt || ticket['CreatedAt']) | date:'dd.MM.yyyy' }}
          </td>
          
          <td class="p-4">
            <a [routerLink]="['/dashboard/ticket', ticket.ticketId || ticket['TicketId']]" class="text-primary hover:underline text-sm font-semibold cursor-pointer">
              Detay
            </a>
          </td>
        </tr>
      </tbody>
    </table>
    
    <div *ngIf="displayedTickets.length === 0" class="p-10 text-center text-slate-500 font-medium">
      <svg class="w-12 h-12 mx-auto text-slate-300 mb-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
      SeÃ§ili kategoriye ait bilet bulunamadÄ±.
    </div>
  </div>
</div>